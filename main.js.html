

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Source: main.js | Js Docs - SmartBots | SBL</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-jsdoc.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/tui-doc.css">

    
</head>
<body>
<nav class="lnb" id="lnb">
    <div class="logo" style="; height: 150px">
        
            <a href="https://smartbots.tk" rel="noopener noreferrer" target="_blank">
                <img src="https://cdn.discordapp.com/icons/878513630793056297/e206ad3903fc35b98fe2ef505897bb5d.png?size=1024" width="100%" height="100%">
            </a>
        
    </div>
    <div class="title">
        <h1><a href="index.html" class="link">Js Docs - SmartBots | SBL</a></h1>
        
    </div>
    <div class="search-container" id="search-container">
        <input type="text" placeholder="Search">
        <ul></ul>
    </div>
    
    <div class="lnb-api hidden"><h3>Classes</h3><ul><li><a href="SBLApi.html">SBLApi</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="SBLApi_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="SBLApi.html#getBotLikes">getBotLikes</a></li><li><a href="SBLApi.html#postServerCount">postServerCount</a></li></ul></div></li><li><a href="SBLError.html">SBLError</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="SBLError_sub"></div></li></ul></div><div class="lnb-api hidden"><h3><a href="global.html">Global</a></h3></div>
</nav>
<div id="resizer"></div>

<div class="main" id="main">
    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>const EventEmitter = require("eventemitter3");
const phin = require("phin");
const SBLError = require("./error");
const fetch = require("node-fetch");

class SBLApi extends EventEmitter {
	/**
	 * main class
	 * @param {string} id - the clients id
	 * @param {string} token - the clients api token
	 */
	constructor(id, token) {
		if (!id) throw new TypeError("missing client id");
		if (!token) throw new TypeError("missing token");
		
		super();

		this._id = id;
		this._token = token;
	}

	get id() {
		return this._id;
	}

	get token() {
		return this._token;
	}


	/**
	 * Fetches a bot's like info, will return null if the bot does not exist
	 * @param {string} [id] - client id, if different from current client id
	 * @param {string} [auth] - different authorization to use, if needed
	 * @returns {Promise&lt;APIBotLikes>} 
	 */
	async getBotLikes(id = this.id, auth = this.token) {
		if (!id) throw new TypeError("missing bot id");
		return phin({
			url: `https://smartbots.tk/api/auth/liked/${id}/`,
			headers: {
				"authorization": auth
			},
			parse: "json"
		}).then((b) => {
			if (b.statusCode !== 200) switch (b.statusCode) {
				case 400:
				case 401:
				case 403:
					throw new SBLError({
						statusCode: b.statusCode,
						body: b.body,
						type: "request error"
					});
					break;

				case 404:
					return null;
					break;

				case 500:
				case 502:
					throw new SBLError({
						statusCode: b.statusCode,
						body: b.body,
						type: "server error"
					});
					break;

				default:
					throw new SBLError({
						statusCode: b.statusCode,
						body: b.body,
						type: "unknown"
					});
			}
			if (!b.body.success) {
				throw new SBLError({
					success: b.body.success,
					error: b.body.error
				});
			}
			return {
				likers: b.body.users
			};
		}).catch(err => {
			throw err;
		});
	}



	/**
	 * post your bots server count stats
	 * @param {number} server_count - the number of servers your bot is in
	 * @param {string} [id] - the id to post stats to, if different from the current id
	 * @param {string} [auth] - different authorization to use, if needed
	 * @returns {Promise&lt;{ success: boolean }>}
	 */
	async postServerCount(server_count = 0, id = this.id, auth = this.token) {
		var ropts = {
			method: "POST",
			url: `https://smartbots.tk/api/auth/stats/${id || this.id}`,
			body: JSON.stringify({"server_count": server_count || 1}),
			headers: {
				"authorization": auth || this.token,
				"Content-Type": "application/json"
			}
		}
		fetch(ropts.url,ropts).then((response) => {return response.text()}).catch(console.error);
	}
}

module.exports = SBLApi;



/**
 * @typedef {object} APIBotLikes
 * @prop {string[]} likers - the likers of last 12 hours
 */

</code></pre>
        </article>
    </section>




</div>

<footer>
    <img class="logo" src="https://cdn.discordapp.com/icons/878513630793056297/e206ad3903fc35b98fe2ef505897bb5d.png?size=1024" style="; height: 150px">
    <div class="footer-text">SmartBots | SBL</div>
</footer>
<script>prettyPrint();</script>
<script src="scripts/jquery.min.js"></script>
<script src="scripts/tui-doc.js"></script>
<script src="scripts/linenumber.js"></script>

    <script>
        var id = '_sub'.replace(/"/g, '_');
        var selectedApi = document.getElementById(id); // do not use jquery selector
        var $selectedApi = $(selectedApi);

        $selectedApi.removeClass('hidden');
        $selectedApi.parent().find('.glyphicon').removeClass('glyphicon-plus').addClass('glyphicon-minus');
        showLnbApi();
    </script>

</body>
</html>
